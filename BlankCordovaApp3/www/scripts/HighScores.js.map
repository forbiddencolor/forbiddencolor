{"version":3,"file":"HighScores.js","sourceRoot":"","sources":["../../scripts/HighScores.ts"],"names":["HighScore","HighScore.constructor","HighScoreStorage","HighScoreStorage.constructor","HighScoreStorage.getHighScores","HighScoreStorage.isHighScore","HighScoreStorage.addScore","HighScoreStorage.addHighScore","HighScoreStorage.resetScores","HighScoreStorage.sort"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nexport class HighScore {\r\n    public name: string;\r\n    public score: number;\r\n    public longestStreak: number;\r\n}\r\n\r\nexport class HighScoreStorage {\r\n    public maxEntries: number;\r\n\r\n    constructor(maxEntries: number = 5) {\r\n        this.maxEntries = maxEntries;\r\n    }\r\n\r\n    public getHighScores(): HighScore[] {\r\n        var scores: HighScore[];\r\n\r\n        try {\r\n            var highscoresStr = localStorage.getItem('highscores');\r\n            var highscores = JSON.parse(highscoresStr);\r\n            if (!highscores || !highscores.scores) {\n                this.resetScores();\r\n                return this.getHighScores();\n            }\r\n            scores = highscores.scores;\r\n        } catch (ex) {\r\n            this.resetScores();\r\n            return this.getHighScores();\r\n        }\r\n\r\n        return scores.sort(this.sort);\r\n    }\r\n\r\n    public isHighScore(score: number) {\r\n        var highScores = this.getHighScores();\r\n        if (highScores.length < this.maxEntries) return true;\r\n\r\n        for (var hscore of highScores) {\r\n            if (score < hscore.score)\r\n                return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public addScore(name: string, score: number, longestStreak: number = 0): boolean {\r\n        var hscore = new HighScore();\r\n        hscore.name = name;\r\n        hscore.score = score;\r\n        hscore.longestStreak = longestStreak;\r\n        return this.addHighScore(hscore);\r\n    }\r\n\r\n    public addHighScore(score: HighScore): boolean {\r\n        if (!this.isHighScore(score.score))\r\n            return false;\r\n\r\n        var scores = this.getHighScores();\r\n        scores.push(score);\r\n\r\n        var sorted = scores.sort(this.sort);\r\n        sorted.slice(0, this.maxEntries);\r\n\r\n        var highscores = { scores: scores };\n        localStorage.setItem('highscores', JSON.stringify(highscores));\r\n        return true;\r\n    }\r\n\r\n    public resetScores() {\r\n        var highscores = { scores: [{ name: 'ros', score: 2 }, { name: 'joh', score: 1 }] };\n        localStorage.setItem('highscores', JSON.stringify(highscores));\n    }\r\n\r\n    private sort(a: any, b: any) {\r\n        return a.score < b.score ? 1 : 0;\r\n    }\r\n}"]}
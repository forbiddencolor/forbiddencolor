{"version":3,"file":"ripple.js","sourceRoot":"","sources":["../../scripts/ripple.ts"],"names":["init","onDocumentMouseDown","onDocumentMouseMove","onDocumentMouseUp","onDocumentMouseOut","onDocumentTouchStart","onDocumentTouchMove","onDocumentTouchEnd","onDocumentKeyUp","emit","loop"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nvar QUALITY = 1,\r\n    WIDTH = Math.floor(window.innerWidth / QUALITY),\r\n    HEIGHT = Math.floor(window.innerHeight / QUALITY),\r\n    SIZE = WIDTH * HEIGHT,\r\n\r\n    context,\r\n    image,\r\n    data,\r\n    buffer1,\r\n    buffer2,\r\n    tempbuffer,\r\n\r\n    isUserInteracting,\r\n    pointers;\r\n\r\nexport function init() {\r\n    var $container = $(\"body\");\r\n    var canvas = document.createElement(\"canvas\");\r\n    canvas.width = WIDTH;\r\n    canvas.height = HEIGHT;\r\n\r\n    var $canvas = $(canvas);\r\n    $canvas.css({\r\n        position: \"absolute\",\r\n        left: 0,\r\n        top: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        zIndex: -1\r\n    });\r\n\r\n    $container.append(canvas);\r\n\r\n    context = canvas.getContext(\"2d\");\r\n    context.fillStyle = $(\"body\").css(\"background-color\");\r\n    context.fillRect(0, 0, WIDTH, HEIGHT);\r\n    image = context.getImageData(0, 0, WIDTH, HEIGHT);\r\n    data = image.data;\r\n\r\n    buffer1 = [];\r\n    buffer2 = [];\r\n\r\n    for (var i = 0; i < SIZE; i++) {\r\n\r\n        buffer1[i] = 0;\r\n        buffer2[i] = i > WIDTH && i < SIZE - WIDTH && Math.random() > 0.995 ? 255 : 0;\r\n    }\r\n\r\n    document.addEventListener(\"mousedown\", onDocumentMouseDown, false);\r\n    document.addEventListener(\"mousemove\", onDocumentMouseMove, false);\r\n    document.addEventListener(\"mouseup\", onDocumentMouseUp, false);\r\n    document.addEventListener(\"mouseout\", onDocumentMouseOut, false);\r\n\r\n    document.addEventListener(\"touchstart\", onDocumentTouchStart, false);\r\n    document.addEventListener(\"touchmove\", onDocumentTouchMove, false);\r\n    document.addEventListener(\"touchend\", onDocumentTouchEnd, false);\r\n\r\n    document.addEventListener(\"keyup\", onDocumentKeyUp, false);\r\n\r\n    $(window).on(\"resize\", () => {\r\n        if (window.innerWidth !== canvas.width || window.innerHeight !== canvas.height) {\r\n            canvas.width = window.innerWidth;\r\n            canvas.height = window.innerHeight;\r\n        }\r\n    });\r\n\r\n    setInterval(loop, 1000 / 60);\r\n}\r\n\r\n// Event Handlers\r\n\r\nfunction onDocumentMouseDown(event) {\r\n    event.preventDefault();\r\n    isUserInteracting = true;\r\n    pointers = [[event.clientX / QUALITY, event.clientY / QUALITY]];\r\n}\r\n\r\nfunction onDocumentMouseMove(event) {\r\n    pointers = [[event.clientX / QUALITY, event.clientY / QUALITY]];\r\n}\r\n\r\nfunction onDocumentMouseUp(event) {\r\n    isUserInteracting = false;\r\n}\r\n\r\nfunction onDocumentMouseOut(event) {\r\n    isUserInteracting = false;\r\n}\r\n\r\nfunction onDocumentTouchStart(event) {\r\n    isUserInteracting = true;\r\n    event.preventDefault();\r\n    pointers = [];\r\n    for (var i = 0; i < event.touches.length; i++) {\r\n        pointers.push([event.touches[i].pageX / QUALITY, event.touches[i].pageY / QUALITY]);\r\n    }\r\n}\r\n\r\nfunction onDocumentTouchMove(event) {\r\n    event.preventDefault();\r\n    pointers = [];\r\n    for (var i = 0; i < event.touches.length; i++) {\r\n        pointers.push([event.touches[i].pageX / QUALITY, event.touches[i].pageY / QUALITY]);\r\n    }\r\n}\r\n\r\nfunction onDocumentTouchEnd(event) {\r\n    event.preventDefault();\r\n    isUserInteracting = false;\r\n}\r\n\r\nfunction onDocumentKeyUp(e) {\r\n    emit(Math.random() * WIDTH, Math.random() * HEIGHT);\r\n}\r\n\r\nfunction emit(x, y) {\r\n    buffer1[Math.floor(x) + (Math.floor(y) * WIDTH)] = 255;\r\n}\r\n\r\nfunction loop() {\r\n    if (isUserInteracting) {\r\n        for (var i = 0; i < pointers.length; i++) {\r\n            emit(pointers[i][0], pointers[i][1]);\r\n        }\r\n    }\r\n\r\n    var pixel;\r\n    var iMax = (WIDTH * HEIGHT) - WIDTH;\r\n\r\n    for (var i = WIDTH; i < iMax; i++) {\r\n        pixel = ((buffer1[i - 1] + buffer1[i + 1] + buffer1[i - WIDTH] + buffer1[i + WIDTH]) >> 1) - buffer2[i];\r\n        pixel -= pixel >> 20;\r\n        buffer2[i] = pixel;\r\n        pixel = pixel > 255 ? 255 : pixel < 0 ? 0 : pixel;\r\n        data[(i * 4) + 1] = pixel;\r\n        data[((i + 1) * 4) + 2] = pixel;\r\n    }\r\n\r\n    tempbuffer = buffer1;\r\n    buffer1 = buffer2;\r\n    buffer2 = tempbuffer;\r\n\r\n    // context.fillStyle = $(\"body\").css(\"background-color\");\r\n    // context.fillRect(0, 0, WIDTH, HEIGHT);\r\n    context.putImageData(image, 0, 0);\r\n}"]}